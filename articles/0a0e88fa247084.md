---
title: "Container Image ã‚’ Validation ã™ã‚‹"
emoji: "ğŸ—‚"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [Docker]
published: false
---

ç§ã®æ‰€å±ã™ã‚‹ãƒãƒ¼ãƒ ã§ã¯ç¤¾å†…åŸºç›¤ã‚’é‹ç”¨ã—ã¦ãŠã‚Šã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç”¨æ„ã—ãŸ Image ã‚’ç¤¾å†…åŸºç›¤ä¸Šã§å‹•ã‹ã™ã‚±ãƒ¼ã‚¹ãŒã‚ã‚Šã¾ã™ã€‚
ãã®éš›ãƒ¦ãƒ¼ã‚¶ãƒ¼ã® Image ãŒè‡ªåˆ†ãŸã¡ã®åŸºç›¤ä¸Šã§å•é¡Œãªãå‹•ãã‹ã‚’äº‹å‰ã«ç¢ºèªã—ãŸã„ã¨ã„ã†è¦æœ›ãŒã‚ã‚Šã¾ã—ãŸã€‚

[NVIDIA Container Canary](https://github.com/NVIDIA/container-canary) ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ registry ã«ä¿ç®¡ã•ã‚ŒãŸ Image ãŒè¦ä»¶ã‚’æº€ãŸã—ã¦ã„ã‚‹ã‹æ¤œè¨¼ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```yaml
# examples/kubeflow.yaml
apiVersion: container-canary.nvidia.com/v1
kind: Validator
name: kubeflow
description: Kubeflow notebooks
env:
  - name: NB_PREFIX
    value: /hub/jovyan/
ports:
  - port: 8888
    protocol: TCP
volumes:
  - mountPath: /home/jovyan
checks:
  - name: user
    description: ğŸ‘© User is jovyan
    probe:
      exec:
        command:
          - /bin/sh
          - -c
          - "[ $(whoami) = jovyan ]"
  - name: uid
    description: ğŸ†” User ID is 1000
    probe:
      exec:
        command:
          - /bin/sh
          - -c
          - "id | grep uid=1000"
  - name: home
    description: ğŸ  Home directory is /home/jovyan
    probe:
      exec:
        command:
          - /bin/sh
          - -c
          - "[ $HOME = /home/jovyan ]"
  - name: http
    description: ğŸŒ Exposes an HTTP interface on port 8888
    probe:
      httpGet:
        path: /
        port: 8888
      initialDelaySeconds: 10
  - name: NB_PREFIX
    description: ğŸ§­ Correctly routes the NB_PREFIX
    probe:
      httpGet:
        path: /hub/jovyan/lab
        port: 8888
      initialDelaySeconds: 10
  - name: allow-origin-all
    description: "ğŸ”“ Sets 'Access-Control-Allow-Origin: *' header"
    probe:
      httpGet:
        path: /
        port: 8888
        responseHttpHeaders:
          - name: Access-Control-Allow-Origin
            value: "*"
      initialDelaySeconds: 10
```

