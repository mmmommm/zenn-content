---
title: "vue2.xã‹ã‚‰composition-apiã«æ›¸ãæ›ãˆãŸ"
emoji: "ğŸ”–"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [vue, typescript]
published: false
---

# ã¯ã˜ã‚ã«
è‡ªä½œã—ãŸ[ã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒª](https://github.com/mmmommm/brand-memo)ã‚’classã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®æ›¸ãæ–¹ã‹ã‚‰composition-apiã®æ›¸ãæ–¹ã«å¤‰æ›´ã—ã¾ã—ãŸã€‚
vuetifyã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã®ã§ã™ãŒã€vuetifyã¯ã¾ã vue3ã«å¯¾å¿œã—ã¦ã„ãªã„ã®ã§composition-apiã«æ›¸ãæ›ãˆã¾ã—ãŸã€‚
ä¸€å¿œãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç­‰ã‚’ã¿ãªãŒã‚‰ã‚„ã£ã¦ã€å•é¡Œãªãå‹•ãçŠ¶æ…‹ã§ã™ãŒã€æ›¸ãæ–¹é–“é•ã£ã¦ã„ãŸã‚Šã—ãŸã‚‰æ•™ãˆã¦ãã ã•ã„ã€‚
[ã“ã‚Œä»¥é™ã®Commit](https://github.com/mmmommm/brand-memo/commit/66acea840df8c0203f94aa536d1710bcd28761f3)ãŒå¤‰æ›´ã«è©²å½“ã—ã¦ã„ã¾ã™ã€‚

## componentã®å®šç¾©
defineComponentã¨ã„ã†ã‚‚ã®ã‚’importã—ã¦ãã®ä¸­ã§componentã‚’å®šç¾©ã™ã‚Œã°å•é¡Œãªã„ã§ã™ã€‚
å®šç¾©ã—ãŸcomponentåã§templateã®ä¸­ã‹ã‚‰å‘¼ã³å‡ºã›ã¾ã™ã€‚
```vue:loading-screen.vue
<template>
  <div>
    <div class="fullview">
      <div class="loading-spacer" />
      <vue-loading
        type="cylon"
        color="#33CCCC"
        :size="{ width: '100px', height: '100px' }"
      />
    </div>
  </div>
</template>
<script lang="ts">
import { defineComponent } from '@vue/composition-api'
import { VueLoading } from 'vue-loading-template'
export default defineComponent ({
  components: {
    VueLoading
  }
})
</script>
```

## props
è¦ªã‹ã‚‰å€¤ã‚’æ¸¡ã—ã¦è¡¨ç¤ºã—ãŸã„æ™‚ãŒã‚ã‚‹ã¨æ€ã„ã¾ã™ã€‚
ä»¥ä¸‹ã¯ãƒªãƒ³ã‚¯ã®é·ç§»å…ˆã®urlã‚’æ¸¡ã—ã¦ã„ã‚‹ä¾‹ã§ã™ã€‚(vuetifyã¯å¤–éƒ¨ãƒªãƒ³ã‚¯ã®éš›ã«v-btnã‚’ä½¿ç”¨ã™ã‚‹ã®ã§ã‚ã‹ã‚Šã«ãã„ã§ã™ã”ã‚ã‚“ãªã•ã„)
```vue:base-link.vue
<template>
  <div>
    <v-btn
      text
      :to="url"
    >
      <slot />
    </v-btn>
  </div>
</template>
<script lang="ts">
import { defineComponent } from '@vue/composition-api'
export default defineComponent ({
  props: {
    url: {
      type: String,
      default: "",
      required: true,
    }
  },
  setup(props) {
    props.url
  }
})
</script>
```
ä¸Šè¨˜ã®ã‚ˆã†ã«typeã§å‹å®šç¾©ã—ãŸã‚Šã§ãã‚‹ã®ã¯ä»¥å‰ã¨åŒã˜ã§ã™ã€‚
å—ã‘å–ã£ãŸpropsã¯`props.url`ã®ã‚ˆã†ãªå½¢ã§setupé–¢æ•°å†…ã§å‘¼ã¶ã“ã¨ã§templateå†…ã§ä½¿ç”¨ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚
è¦ªã®componentã§å‘¼ã¶ã¨ãã¯ä»¥ä¸‹ã®ã‚ˆã†ã«æ›¸ãã¾ã™ã€‚
```vue:sample.vue
<template>
  <BaseLink url="/">
    Home
  </BaseLink>
</template>
<script lang="ts">
import { defineComponent } from '@vue/composition-api'
import BaseLink from '@/components/atoms/base-link.vue'
export default defineComponent ({
  components: {
    BaseLink,
  }
})
</script>
```

# emit
å­ã§ç™ºç«ã—ãŸã‚¤ãƒ™ãƒ³ãƒˆã‚’è¦ªã«æ¸¡ã™å ´åˆã«ã¯
```vue:base-button.vue
<template>
  <v-btn
    text
    outlined
    @click="click"
  >
    <slot />
  </v-btn>
</template>
<script lang="ts">
import { defineComponent, SetupContext } from '@vue/composition-api'
export default defineComponent ({
  setup(props, context: SetupContext) {
    const click = () => {
      context.emit("click")
    }
    return {
      click
    }
  }
})
</script>
```
ã“ã‚“ãªæ„Ÿã˜ã§æ›¸ã‘ã°è¦ªã§ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆã‚’å—ã‘å–ã‚Œã¾ã™
```vue:search-button.vue
<template>
  <BaseButton
    class="mt-2 filter"
    @click="filteredList"
  >
    æ¤œç´¢
  </BaseButton>
</template>
<script lang="ts">
import { defineComponent } from '@vue/composition-api'
import BaseButton from '@/components/atoms/base-button.vue'
export default defineComponent ({
  components: {
    BaseButton,
  },
  setup(props, { emit, root }) {
})
```
# vuex
vuexã®å‘¼ã³å‡ºã—ã«é–¢ã—ã¦ã¯ä»Šã¾ã§`this.$store.commit('')`ã ã£ãŸã‚‚ã®ãŒ`root.$store.commit()`ã®ã‚ˆã†ãªå½¢ã«ãªã‚‹ã ã‘ã§ã™ã€‚
rootã¯setupé–¢æ•°ã®ç¬¬äºŒå¼•æ•°ã§åˆ†å‰²ä»£å…¥ã‚’ç”¨ã„ã¦å–å¾—ã™ã‚‹ã“ã¨ã§ä½¿ã†ã“ã¨ãŒã§ãã¾ã™ã€‚
```vue:sample.vue
<script lang="ts">
import { defineComponent } from '@vue/composition-api'
export default defineComponent({
  setup(_, { root }){
    const sample = () => {
      root.$store.commit('setLoading', true)
    }
  }
})
</script>
```
## gettersã«ã¤ã„ã¦
mutationsã¨actionsã«é–¢ã—ã¦ã¯ä¸Šè¨˜ã®ã‚ˆã†ã«æ›¸ã‘ã°å•é¡Œãªã„ã§ã™ãŒã€‚
gettersã«é–¢ã—ã¦ã¯computedã‚’ç”¨ã„ã¦æ›¸ãã¾ã™ã€‚
```vue:before.vue
<script lang="ts">
import { Component, Vue } from 'vue-property-decorator'
@Component
export default class Sample extends Vue {
  isLoading(): boolean {
    return this.$store.getters.isLoading
  }
}
</script>
```
```vue:after.vue
<script lang="ts">
import { defineComponent, computed } from '@vue/composition-api'
export default defineComponent({
  setup(_, { root }){
    const isLoading = computed(() => root.$store.getters.isLoading)
  }
  return {
    isLoading
  }
})
</script>
```
# é–¢æ•°éƒ¨åˆ†ã®åˆ†é›¢
composition-apiã‚’ç”¨ã„ã‚‹ã“ã¨ã«ã‚ˆã£ã¦é–¢æ•°éƒ¨åˆ†ã‚’åˆ†é›¢ã—ã‚„ã™ããªã‚Šã¾ã—ãŸã€‚
